---
title: "Senator_Voting_Data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown



```{r libraries}
library(dplyr)
library(ggplot2)
library(tidyverse)
```




```{r data}
senator_party <- read.csv(file="senator_party.csv")
senator_votes_1 <- read.csv(file="senator_votes_113-1.csv")
senator_votes_2 <- read.csv(file="senator_votes_113-2.csv")
senators <- read.csv(file="senator.csv")
result_code <- read.csv(file="result_code_list.csv")
tally_code <- read.csv(file="tally_code_list.csv")
```

```{r combine table}

vote_table <- select(senator_votes_1,voteno,member_code,tally_code) %>%
  filter(tally_code %in% c("A","B"))

vote_table$tally_code = ifelse(vote_table$tally_code=="A",0,1)

party_votes <- left_join(vote_table,select(senator_party,member_code,caucus_with), by = "member_code")

party_votes

party_vote_count <- party_votes %>%
  select(voteno, caucus_with, tally_code) %>%
  group_by(voteno, caucus_with) %>%
  mutate( total_party_votes = sum(voteno)/voteno ) %>%
  group_by(voteno, caucus_with, total_party_votes) %>%
  summarise( total_party_support = sum(tally_code) )

party_vote_count <- party_vote_count %>%
  mutate( avg_party_support = total_party_support/total_party_votes)

party_vote_count
  

party_support_difference <- select(party_vote_count,voteno,caucus_with,avg_party_support) %>%
  spread(key = caucus_with, value = avg_party_support) %>%
  mutate( difference = D-R )

party_support_difference



name_votes <- left_join(party_votes,select(senators,member_code,print_name), by = "member_code")

#name_votes

group_votes <- select(name_votes,voteno,tally_code,caucus_with) %>%
  group_by(caucus_with) %>%
  summarise( total = sum(tally_code) )

#group_votes



```



```{r plot}

party_support_differenceD <- party_support_difference[order(party_support_difference$D),] %>%
  rowid_to_column()

party_support_differenceR <- party_support_difference[order(party_support_difference$R),] %>%
  rowid_to_column()

party_support_differenceD

party_support_differenceR %>% ggplot() + geom_point( aes( x=as.factor(rowid), y=D), color="blue") + geom_point( aes( x=as.factor(rowid), y=R), color="red") + xlab("Vote") + ylab("Party Support")

#party_support_difference2 %>% ggplot( ) + geom_point( aes( x=voteno, y=D ), color="blue") + geom_point( aes( x=voteno, y=R ), color="red") + xlab("Vote Number") + ylab("Party Support")

party_support_difference %>% ggplot( ) + geom_point( aes(x=voteno, y=difference), color="green")

```


```{r consitency}

name_votes_D <- select(name_votes,)

```




